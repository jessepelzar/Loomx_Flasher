import {R as A} from "./rom-7e8b4fbe.js";
var C = 1074521560,
    I = "CAD0PxwA9D8AAPQ/AMD8PxAA9D82QQAh+v/AIAA4AkH5/8AgACgEICB0nOIGBQAAAEH1/4H2/8AgAK" +
            "gEiAigoHTgCAALImYC54b0/yHx/8AgADkCHfAAAKDr/T8Ya/0/hIAAAEBAAABYq/0/pOv9PzZBALH5" +
            "/yCgdBARIKXHAJYaBoH2/5KhAZCZEZqYwCAAuAmR8/+goHSaiMAgAJIYAJCQ9BvJwMD0wCAAwlgAmp" +
            "vAIACiSQDAIACSGACB6v+QkPSAgPSHmUeB5f+SoQGQmRGamMAgAMgJoeX/seP/h5wXxgEAfOiHGt7G" +
            "CADAIACJCsAgALkJRgIAwCAAuQrAIACJCZHX/5qIDAnAIACSWAAd8AAA+CD0P/gw9D82QQCR/f/AIA" +
            "CICYCAJFZI/5H6/8AgAIgJgIAkVkj/HfAAAAAQIPQ/ACD0PwAAAAg2QQAQESCl/P8h+v8MCMAgAIJi" +
            "AJH6/4H4/8AgAJJoAMAgAJgIVnn/wCAAiAJ88oAiMCAgBB3wAAAAAEA2QQAQESDl+/8Wav+B7P+R+/" +
            "/AIACSaADAIACYCFZ5/x3wAAAMwPw/////AAQg9D82QQAh/P84QhaDBhARIGX4/xb6BQz4DAQ3qA2Y" +
            "IoCZEIKgAZBIg0BAdBARICX6/xARICXz/4giDBtAmBGQqwHMFICrAbHt/7CZELHs/8AgAJJrAJHO/8" +
            "AgAKJpAMAgAKgJVnr/HAkMGkCag5AzwJqIOUKJIh3wAAAskgBANkEAoqDAgf3/4AgAHfAAADZBAIKg" +
            "wK0Ch5IRoqDbgff/4AgAoqDcRgQAAAAAgqDbh5IIgfL/4AgAoqDdgfD/4AgAHfA2QQA6MsYCAACiAg" +
            "AbIhARIKX7/zeS8R3wAAAAfNoFQNguBkCc2gVAHNsFQDYhIaLREIH6/+AIAEYLAAAADBRARBFAQ2PN" +
            "BL0BrQKB9f/gCACgoHT8Ws0EELEgotEQgfH/4AgASiJAM8BWA/0iogsQIrAgoiCy0RCB7P/gCACtAh" +
            "wLEBEgpff/LQOGAAAioGMd8AAA/GcAQNCSAEAIaABANkEhYqEHwGYRGmZZBiwKYtEQDAVSZhqB9//g" +
            "CAAMGECIEUe4AkZFAK0GgdT/4AgAhjQAAJKkHVBzwOCZERqZQHdjiQnNB70BIKIggc3/4AgAkqQd4J" +
            "kRGpmgoHSICYyqDAiCZhZ9CIYWAAAAkqQd4JkREJmAgmkAEBEgJer/vQetARARIKXt/xARICXp/80H" +
            "ELEgYKYggbv/4AgAkqQd4JkRGpmICXAigHBVgDe1sJKhB8CZERqZmAmAdcCXtwJG3P+G5v8MCIJGbK" +
            "KkGxCqoIHK/+AIAFYK/7KiC6IGbBC7sBARIKWPAPfqEvZHD7KiDRC7sHq7oksAG3eG8f9867eawWZH" +
            "CIImGje4Aoe1nCKiCxAisGC2IK0CgZv/4AgAEBEgpd//rQIcCxARICXj/xARIKXe/ywKgbH/4AgAHf" +
            "AIIPQ/cOL6P0gkBkDwIgZANmEAEBEg5cr/EKEggfv/4AgAPQoMEvwqiAGSogCQiBCJARARIKXP/5Hy" +
            "/6CiAcAgAIIpAKCIIMAgAIJpALIhAKHt/4Hu/+AIAKAjgx3wAAD/DwAANkEAgTv/DBmSSAAwnEGZKJ" +
            "H7/zkYKTgwMLSaIiozMDxBDAIpWDlIEBEgJfj/LQqMGiKgxR3wAABQLQZANkEAQSz/WDRQM2MWYwRY" +
            "FFpTUFxBRgEAEBEgZcr/iESmGASIJIel7xARIKXC/xZq/6gUzQO9AoHx/+AIAKCgdIxKUqDEUmQFWB" +
            "Q6VVkUWDQwVcBZNB3wAADA/D9PSEFJqOv9P3DgC0AU4AtADAD0PzhA9D///wAAjIAAABBAAACs6/0/" +
            "vOv9PwTA/D8IwPw/BOz9PxQA9D/w//8AqOv9Pxjr/D8kwPw/fGgAQOxnAEBYhgBAbCoGQDgyBkAULA" +
            "ZAzCwGQEwsBkA0hQBAzJAAQHguBkAw7wVAWJIAQEyCAEA2wQAh3v8MCiJhCEKgAIHu/+AIACHZ/zHa" +
            "/8YAAEkCSyI3MvgQESBlw/8MS6LBIBARIOXG/yKhARARICXC/1GR/pAiESolMc//sc//wCAAWQIheP" +
            "4MDAxaMmIAgdz/4AgAMcr/QqEBwCAAKAMsCkAiIMAgACkDgTH/4AgAgdX/4AgAIcP/wCAAKALMuhzD" +
            "MCIQIsL4DBMgo4MMC4HO/+AIAPG8/wwdwqABDBvioQBA3REAzBGAuwGioACBx//gCAAhtv8MBCpVIc" +
            "P+ctIrwCAAKAUWcv/AIAA4BQwSwCAASQUiQRAiAwEMKCJBEYJRCUlRJpIHHDiHEh4GCAAiAwOCAwKA" +
            "IhGAIiBmQhEoI8AgACgCKVFGAQAAHCIiUQkQESCls/8Mi6LBEBARIGW3/4IDAyIDAoCIESCIICGY/y" +
            "Ag9IeyHKKgwBARICWy/6Kg7hARIKWx/xARICWw/4bb/wAAIgMBHDknOTT2IhjG1AAAACLCLyAgdPZC" +
            "cJGJ/5AioCgCoAIAIsL+ICB0HBknuQLGywCRhP+QIqAoAqACAJLCMJCQdLZZyQbGACxKbQQioMCnGA" +
            "IGxABJUQxyrQQQESDlqv+tBBARIGWq/xARIOWo/xARIKWo/wyLosEQIsL/EBEg5av/ViL9RikADBJW" +
            "yCyCYQ+Bev/gCACI8aAog8auACaIBAwSxqwAmCNoM2CJIICAtFbY/pnBEBEgZcf/mMFqKZwqBvf/AA" +
            "CgrEGBbf/gCABW6vxi1vBgosDMJgaBAACgkPRWGf6GBACgoPWZwYFl/+AIAJjBVpr6kGbADBkAmRFg" +
            "osBnOeEGBAAAAKCsQYFc/+AIAFaq+GLW8GCiwFam/sZvAABtBCKgwCaIAoaNAG0EDALGiwAAACa484" +
            "ZhAAwSJrgCBoUAuDOoIxARIOWh/6AkgwaBAAwcZrhTiEMgrBFtBCKgwoe6AoZ+ALhTqCPJ4RARIOXA" +
            "/8YLAAwcZrgviEMgrBFtBCKgwoe6AoZ1ACgzuFOoIyBogsnhEBEgZb7/ITT+SWIi0itpIsjhoMSDLQ" +
            "yGaQChL/5tBLIKACKgxhY7GpgjgsjwIqDAh5kBKFoMCaKg70YCAJqzsgsYG5mwqjCHKfKCAwWSAwSA" +
            "iBGQiCCSAwZtBACZEYCZIIIDB4CIAZCIIICqwIKgwaAok0ZVAIEY/m0EoggAIqDGFnoUqDgioMhW+h" +
            "MoWKJIAMZNAByKbQQMEqcYAsZKAPhz6GPYU8hDuDOoI4EM/+AIAG0KoCSDRkQAAAwSJkgCRj8AqCO9" +
            "BIEE/+AIAAYeAICwNG0EIqDAVgsPgGRBi8N8/UYOAKg8ucHJ4dnRgQD/4AgAyOG4wSgsmByoDNIhDZ" +
            "CSECYCDsAgAOIqACAtMOAiECCZIMAgAJkKG7vCzBBnO8LGm/9mSAJGmv9tBCKgwAYmAAwSJrgCRiEA" +
            "Idz+mFOII5kCIdv+iQItBIYcAGHX/gwb2AaCyPCtBC0EgCuT0KuDIKoQbQQioMZW6gXB0f4ioMnoDI" +
            "c+U4DwFCKgwFavBC0KRgIAKqOoaksiqQmtCyD+wCqdhzLtFprfIcT++QyZAsZ7/wwSZogWIcH+iAIW" +
            "KACCoMhJAiG9/kkCDBKAJINtBEYBAABtBCKg/yCgdBARIOV5/2CgdBARIGV5/xARIOV3/1aiviIDAR" +
            "woJzge9jICBvf+IsL9ICB0DPgnuAKG8/6BrP6AIqAoAqACAIKg0ocSUoKg1IcSegbt/gAAAIgzoqJx" +
            "wKoRaCOJ8YGw/uAIACGh/pGi/sAgACgCiPEgNDXAIhGQIhAgIyCAIoKtBGCywoGn/uAIAKKj6IGk/u" +
            "AIAAbb/gAA2FPIQ7gzqCMQESAlff9G1v4AsgMDIgMCgLsRILsgssvwosMYEBEgZZn/Rs/+ACIDA4ID" +
            "AmGP/YAiEZg2gCIgIsLwkCJjFiKymBaakpCcQUYCAJnBEBEgZWL/mMGoRqYaBKgmp6nrEBEgpVr/Fm" +
            "r/qBbNArLDGIGG/uAIAIw6MqDEOVY4FiozORY4NiAjwCk2xrX+ggMCIsMYMgMDDByAMxGAMyAyw/AG" +
            "IwCBbP6RHf3oCDlx4JnAmWGYJwwal7MBDDqJ8anR6cEQESAlW/+o0ZFj/ujBqQGhYv7dCb0CwsEc8s" +
            "EYmcGBa/7gCAC4J80KqHGI8aC7wLknoDPAuAiqIqhhmMGqu90EDBq5CMDag5C7wNDgdMx90tuA0K6T" +
            "FmoBrQmJ8ZnByeEQESAlif+I8ZjByOGSaABhTv2INoyjwJ8xwJnA1ikAVvj11qwAMUn9IqDHKVNGAA" +
            "CMPJwIxoL+FoigYUT9IqDIKVZGf/4AMUH9IqDJKVNGfP4oI1bCnq0EgUX+4AgAoqJxwKoRgT7+4AgA" +
            "gUL+4AgAxnP+AAAoMxaCnK0EgTz+4AgAoqPogTb+4AgA4AIARmz+HfAAAAA2QQCdAoKgwCgDh5kPzD" +
            "IMEoYHAAwCKQN84oYPACYSByYiGIYDAAAAgqDbgCkjh5kqDCIpA3zyRggAAAAioNwnmQoMEikDLQgG" +
            "BAAAAIKg3Xzyh5kGDBIpAyKg2x3wAAA=",
    g = 1074520064,
    B = "GOv8P9jnC0Bx6AtA8+wLQO3oC0CP6AtA7egLQEnpC0AG6gtAeOoLQCHqC0CB5wtAo+kLQPjpC0Bn6Q" +
            "tAmuoLQI7pC0Ca6gtAXegLQLPoC0Dt6AtASekLQHfoC0BM6wtAs+wLQKXmC0DX7AtApeYLQKXmC0Cl" +
            "5gtApeYLQKXmC0Cl5gtApeYLQKXmC0Dz6gtApeYLQM3rC0Cz7AtA",
    i = 1073605544;
class E extends A {
    constructor() {
        super(...arguments),
        this.CHIP_NAME = "ESP32",
        this.IMAGE_CHIP_ID = 0,
        this.EFUSE_RD_REG_BASE = 1073061888,
        this.DR_REG_SYSCON_BASE = 1073111040,
        this.UART_CLKDIV_REG = 1072955412,
        this.UART_CLKDIV_MASK = 1048575,
        this.UART_DATE_REG_ADDR = 1610612856,
        this.XTAL_CLK_DIVIDER = 1,
        this.FLASH_SIZES = {
            "1MB": 0,
            "2MB": 16,
            "4MB": 32,
            "8MB": 48,
            "16MB": 64
        },
        this.FLASH_WRITE_SIZE = 1024,
        this.BOOTLOADER_FLASH_OFFSET = 4096,
        this.SPI_REG_BASE = 1072963584,
        this.SPI_USR_OFFS = 28,
        this.SPI_USR1_OFFS = 32,
        this.SPI_USR2_OFFS = 36,
        this.SPI_W0_OFFS = 128,
        this.SPI_MOSI_DLEN_OFFS = 40,
        this.SPI_MISO_DLEN_OFFS = 44,
        this.TEXT_START = g,
        this.ENTRY = C,
        this.DATA_START = i,
        this.ROM_DATA = B,
        this.ROM_TEXT = I
    }
    async read_efuse(A, C) {
        const I = this.EFUSE_RD_REG_BASE + 4 * C;
        return A.debug("Read efuse " + I),
        await A.read_reg(I)
    }
    async get_pkg_version(A) {
        const C = await this.read_efuse(A, 3);
        let I = C >> 9 & 7;
        return I += (C >> 2 & 1) << 3,
        I
    }
    async get_chip_revision(A) {
        const C = await this.read_efuse(A, 3),
            I = await this.read_efuse(A, 5),
            g = await A.read_reg(this.DR_REG_SYSCON_BASE + 124);
        return 0 != (C >> 15 & 1)
            ? 0 != (I >> 20 & 1)
                ? 0 != (g >> 31 & 1)
                    ? 3
                    : 2
                : 1
            : 0
    }
    async get_chip_description(A) {
        const C = [
            "ESP32-D0WDQ6",
            "ESP32-D0WD",
            "ESP32-D2WD",
            "",
            "ESP32-U4WDH",
            "ESP32-PICO-D4",
            "ESP32-PICO-V3-02"
        ];
        let I = "";
        const g = await this.get_pkg_version(A),
            B = await this.get_chip_revision(A),
            i = 3 == B;
        return 0 != (1 & await this.read_efuse(A, 3)) && (
            C[0] = "ESP32-S0WDQ6",
            C[1] = "ESP32-S0WD"
        ),
        i && (C[5] = "ESP32-PICO-V3"),
        I = g >= 0 && g <= 6
            ? C[g]
            : "Unknown ESP32",
        !i || 0 !== g && 1 !== g || (I += "-V3"),
        I + " (revision " + B + ")"
    }
    async get_chip_features(A) {
        const C = ["Wi-Fi"],
            I = await this.read_efuse(A, 3);
        0 === (2 & I) && C.push(" BT");
        0 !== (1 & I)
            ? C.push(" Single Core")
            : C.push(" Dual Core");
        if (0 !== (8192 & I)) {
            0 !== (4096 & I)
                ? C.push(" 160MHz")
                : C.push(" 240MHz")
        }
        const g = await this.get_pkg_version(A);
        -1 !== [2, 4, 5, 6].indexOf(g) && C.push(" Embedded Flash"),
        6 === g && C.push(" Embedded PSRAM");
        0 !== (await this.read_efuse(A, 4) >> 8 & 31) && C.push(
            " VRef calibration in efuse"
        );
        0 !== (I >> 14 & 1) && C.push(" BLK3 partially reserved");
        const B = 3 & await this.read_efuse(A, 6);
        return C.push(
            " Coding Scheme " + ["None", "3/4", "Repeat (UNSUPPORTED)", "Invalid"][B]
        ),
        C
    }
    async get_crystal_freq(A) {
        const C = await A.read_reg(this.UART_CLKDIV_REG) & this.UART_CLKDIV_MASK,
            I = A.transport.baudrate * C / 1e6 / this.XTAL_CLK_DIVIDER;
        let g;
        return g = I > 33
            ? 40
            : 26,
        Math.abs(g - I) > 1 && A.info("WARNING: Unsupported crystal in use"),
        g
    }
    _d2h(A) {
        const C = (+A).toString(16);
        return 1 === C.length
            ? "0" + C
            : C
    }
    async read_mac(A) {
        let C = await this.read_efuse(A, 1);
        C >>>= 0;
        let I = await this.read_efuse(A, 2);
        I >>>= 0;
        const g = new Uint8Array(6);
        return g[0] = I >> 8 & 255,
        g[1] = 255 & I,
        g[2] = C >> 24 & 255,
        g[3] = C >> 16 & 255,
        g[4] = C >> 8 & 255,
        g[5] = 255 & C,
        this._d2h(g[0]) + ":" + this._d2h(g[1]) + ":" + this._d2h(g[2]) + ":" + this._d2h(
            g[3]
        ) + ":" + this._d2h(g[4]) + ":" + this._d2h(g[5])
    }
}
export {
    E as ESP32ROM
};
